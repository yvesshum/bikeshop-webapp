<!DOCTYPE html>
<html>
  <head> 
	<script src="https://www.gstatic.com/firebasejs/5.9.3/firebase.js"></script>
        <script src="https://www.gstatic.com/firebasejs/5.9.3/firebase-firestore.js"></script>
        <script>
            // Initialize Firebase, this is always necessary
            var config = {
                apiKey: "AIzaSyA39Jp3rVTwBrn__rkjbAFp2EZalfZVHYs",
                authDomain: "bikeshoptesting-9e034.firebaseapp.com",
                databaseURL: "https://bikeshoptesting-9e034.firebaseio.com",
                projectId: "bikeshoptesting-9e034",
                storageBucket: "bikeshoptesting-9e034.appspot.com",
                messagingSenderId: "50618401035"
            };
            firebase.initializeApp(config);
        </script>
        <script src="jquery-3.3.1.min.js"></script>
  </head>

  <body>
      <form id="input_form">
      ID Number:<br>
      <input id="id_input" type="number"></input><br>
      <input type="button" id="submit_button" value="Search">
     </form>

     <p>Name:</p>
     <p id="Name_field">placeholder</p>
     <p id="DOB_field">placeholder</p>

     <!-- <form>
	     Input key mmm<br>
	     <input id="keyinput" type="text"></input><br>
	     Input value MMMMMM<br>
	     <input id="valinput" type="text"></input><br>
	     <input id="submitbutton" type="submit" value="SUBMIT ME BB"></input>
     </form> -->
  </body>
  <script>
    var db = firebase.firestore();
    docRef = db.collection("Vince").doc("Person");
    docRef.get().then((doc) => {
      console.log(doc.data());
    });
  </script>

  <!-- <script>
    var db = firebase.firestore();
    docRef = db.collection("Vince").doc("0001")
        .onSnapshot({
        // Listen for document changes (metadata is just non local changes in data in this case)
        includeMetadataChanges: true
    }, function(doc) {
        console.log('new val: ', doc.data());
	    // document.getElementsByTagName("h1")[0].innerHTML = "This is the story of a man named " + doc.data().name;
      document.getElementById("name_field").innerHTML = doc.data().Name;
        });
  </script> -->

  <script>
      // TODO: Change MAX_DIGITS to maximum number of digits in ID
      const MAX_DIGITS = 4;

      function pad_ID(id, digits) {
        return ("0".repeat(digits) + id).slice(-digits);
      }

      const button = document.getElementById("submit_button");
      button.addEventListener("click", display_fields);

      const form = document.getElementById("input_form");
      form.addEventListener("submit", display_fields);

      function display_fields(event) {
        // TODO: Remove explicit id_input reference from this function
        id = pad_ID(document.getElementById("id_input").value, MAX_DIGITS);
        event.preventDefault();
        var db = firebase.firestore();
        docRef = db.collection("Vince").doc(id)
            .onSnapshot({
            includeMetadataChanges: true
        }, function(doc) {
            for (var key in doc.data()) {
              document.getElementById(key + "_field").innerHTML = doc.data()[key];
            };
        });
      }
  </script>

  <script>
        var textID1 = document.getElementByTagName("h1")[0];
        var firebaseRef = firebase.database().ref();
        var dbreftest = firebaseRef.child("Person");
        dbreftest.on('value', (retrieved) => {
                textID1.innerText = retrieved.val();
        });
  </script>

</html>
